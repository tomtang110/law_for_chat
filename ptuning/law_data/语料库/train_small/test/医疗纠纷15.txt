公立医院编制内职工，外出规培结束，想辞职，当时签了编制合同，还有两年到期，规培前还签了协议书，主要内容是规培结束要在单位工作10年，否则需要赔偿金额五万，还有其他一些费用，协议书10年是否符合劳动法，是否有效，以及与聘用合同赔偿金额与协议书不同，与哪个为主？